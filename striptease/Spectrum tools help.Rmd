---
jupyter:
  jupytext:
    formats: ipynb,Rmd
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.4.1
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

# Import and functions

```{python}
import spectrum
import numpy as np
import pylab as pl
from importlib import reload
import pdb
reload(spectrum)
```

# Test with white noise data stream


## Noise generation

```{python}
sigma = 2.
mean = 0.
n_elements = 1000000
noise = np.random.normal(mean, sigma, n_elements)
```

```{python}
pl.plot(noise)
```

## Calculate spectrum

```{python}
reload(spectrum)
```

```{python}
# Create instance to the class
spec_inst = spectrum.Spectrum()
```

```{python}
# Print parameters
spec_inst.parameters()
```

### No windowing

```{python}
# Set sampling frequency
samp_freq = 1.5 #Hz
```

```{python}
# Calculate amplitude spectrum and check white noise level
spec_inst.spectrum_type[0] = 'AS'
spec = spec_inst.spectrum(noise,samp_freq)
wnl = spec_inst.white_noise_level(spec)
pl.plot(spec['frequencies'],spec['amplitudes'])
print('White noise level from spectrum = %4.3f, '
      'standard deviation = %4.3f' % (wnl, np.std(noise)))
```

```{python}
# Calculate amplitude spectral density and check white noise level
spec_inst.spectrum_type[0] = 'ASD'
spec = spec_inst.spectrum(noise,samp_freq)
wnl = spec_inst.white_noise_level(spec)
pl.plot(spec['frequencies'],spec['amplitudes'])
print('White noise level from spectrum = %4.3f, '
      'standard deviation = %4.3f' % (wnl*np.sqrt(samp_freq), np.std(noise)))
```

```{python}
# Calculate power spectrum and check white noise level
spec_inst.spectrum_type[0] = 'PS'
spec = spec_inst.spectrum(noise,samp_freq)
wnl = spec_inst.white_noise_level(spec)
pl.plot(spec['frequencies'],spec['amplitudes'])
print('White noise level from spectrum = %4.3f, '
      'variance = %4.3f' % (wnl, np.std(noise)**2))
```

```{python}
# Calculate power spectral density and check white noise level
spec_inst.spectrum_type[0] = 'PSD'
spec = spec_inst.spectrum(noise,samp_freq)
wnl = spec_inst.white_noise_level(spec)
pl.plot(spec['frequencies'],spec['amplitudes'])
print('White noise level from spectrum = %4.3f, '
      'variance = %4.3f' % (wnl*samp_freq, np.std(noise)**2))
```

<!-- #region heading_collapsed=true -->
### With windowing
<!-- #endregion -->

```{python hidden=TRUE}
# Set sampling frequency
samp_freq = 1.5 #Hz

# Set windowing and lowest freq
spec_inst.welch[0] = True
spec_inst.lowfreq[0] = 1.e-3
```

```{python hidden=TRUE}
# Calculate amplitude spectrum and check white noise level
spec_inst.spectrum_type[0] = 'AS'
spec = spec_inst.spectrum(noise,samp_freq)
wnl = spec_inst.white_noise_level(spec)
pl.plot(spec['frequencies'],spec['amplitudes'])
print('White noise level from spectrum = %4.3f, '
      'standard deviation = %4.3f' % (wnl, np.std(noise)))
```

```{python hidden=TRUE}
# Calculate amplitude spectral density and check white noise level
spec_inst.spectrum_type[0] = 'ASD'
spec = spec_inst.spectrum(noise,samp_freq)
wnl = spec_inst.white_noise_level(spec)
pl.plot(spec['frequencies'],spec['amplitudes'])
print('White noise level from spectrum = %4.3f, '
      'standard deviation = %4.3f' % (wnl*np.sqrt(samp_freq), np.std(noise)))
```

```{python hidden=TRUE}
# Calculate power spectrum and check white noise level
spec_inst.spectrum_type[0] = 'PS'
spec = spec_inst.spectrum(noise,samp_freq)
wnl = spec_inst.white_noise_level(spec)
pl.plot(spec['frequencies'],spec['amplitudes'])
print('White noise level from spectrum = %4.3f, '
      'standard deviation = %4.3f' % (wnl, np.std(noise)**2))
```

```{python hidden=TRUE}
# Calculate power spectral density and check white noise level
spec_inst.spectrum_type[0] = 'PSD'
spec = spec_inst.spectrum(noise,samp_freq)
wnl = spec_inst.white_noise_level(spec)
pl.plot(spec['frequencies'],spec['amplitudes'])
print('White noise level from spectrum = %4.3f, '
      'standard deviation = %4.3f' % (wnl*samp_freq, np.std(noise)**2))
```

```{python hidden=TRUE}

```
